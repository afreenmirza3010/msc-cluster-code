{
"dataset_params": {
        "class_name": "HDF5Reader",
        "config": {
            "filename": "../script/head_neck_new3.h5",
            "batch_size": 2,
            "x_name": "input",
            "y_name": "target",
            "batch_cache": 1,
            "train_folds": [
                0,1,2
            ],
            "val_folds": [
                10
            ],
            "test_folds": [
                15,
                17,
                16
            ]
        }
    },
    "train_params": {
        "callbacks":{
            "class_name": "TensorBoard",
                "config": {
                    "log_dir": "logs",
                    "update_freq":"batch",
                    "profile_batch":  2,
                    "histogram_freq": 1
                },
        "epochs": 30
    },
    "input_params":{

            "shape": [
            173,
            191,
            265,
            2
        ]
    },

    "model_params":{
        "loss": {
            "class_name": "BinaryFbetaLoss"


        },

        "optimizer": {
            "class_name": "adam",
            "config": {
                "learning_rate": 0.0001
            }
        }},

        "metrics": [
            {
                "class_name": "BinaryFbeta"
            },
            "TruePositives",
            "FalsePositives",
            "FalseNegatives"
        ],

    "architecture": {
        "type": "Vnet",
        "layers": [
            {
                "name": "conv1",
                "class_name": "Conv3D",
                "config": {
                    "filters": 1,
                    "kernel_size": 3,
                    "activation": "relu",
                    "kernel_initializer": "he_normal",
                    "padding": "same"
                },
                "normalizer": {
                    "class_name": "BatchNormalization"
                }
            },
            {
                "class_name": "MaxPooling3D"
            },

            {
                "name": "conv2",
                "class_name": "Conv3D",
                "config": {
                    "filters": 1,
                    "kernel_size": 3,
                    "activation": "relu",
                    "kernel_initializer": "he_normal",
                    "padding": "same"
                },
                "normalizer": {
                    "class_name": "BatchNormalization"
                }
            },
            {
                "class_name": "MaxPooling3D"
            },
            {
                "class_name": "Conv3D",
                "config": {
                    "filters": 1,
                    "kernel_size": 3,
                    "activation": "relu",
                    "kernel_initializer": "he_normal",
                    "padding": "same"
                },
                "normalizer": {
                    "class_name": "BatchNormalization"
                }
            },
            {
                "name": "conv_T_1",
                "class_name": "Conv3DTranspose",
                "config": {
                    "filters": 1,
                    "kernel_size": 3,
                    "strides": 1,
                    "kernel_initializer": "he_normal",
                    "padding": "same"
                }
            },
            {
                "name": "conv_T_2",
                "class_name": "Conv3DTranspose",
                "config": {
                    "filters": 1,
                    "kernel_size": 3,
                    "strides": 1,
                    "kernel_initializer": "he_normal",
                    "padding": "same"
                },
                "inputs": [
                    "conv2",
                    "conv_T_1"
                ]
            },

            {
                "class_name": "Conv3D",
                "config": {
                    "filters": 1,
                    "kernel_size": 3,
                    "activation": "sigmoid",
                    "kernel_initializer": "he_normal",
                    "padding": "same"
                },
                "inputs": [
                    "conv1",
                    "conv_T_2"
                ]
            }
        ]
    }
}}
